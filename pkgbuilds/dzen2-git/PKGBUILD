# Maintainer: Andreas B. Wagner <AndreasBWagner@pointfree.net> awagner on irc.freenode.net
# Contributor: Murtuza Akhtari <inxsible at gmail dot com>
# Adopted for updates by: BKLive <bkunixos@gmail.com>

_gitname=dzen
pkgname=dzen2-xft-xpm-xinerama-git
pkgver=271
pkgrel=2
pkgdesc="X notification utility with Xinerama, XPM, XFT and gadgets, svn version"
arch=('i686' 'x86_64')
url=('https://github.com/robm/dzen')
license=('MIT/X')
depends=('libxpm' 'libxinerama' 'libxft' 'libxss')
makedepends=('git' 'gcc' 'pkg-config' 'db')
provides=('dzen2')
conflicts=('dzen2' 'dzen2-gadgets-svn' 'dzen2-git')
source=("git://github.com/klasbj/dzen.git")
sha256sums=(SKIP)

build() {
  msg "Starting make..."

  cd "$srcdir/$_gitname"
  make X11INC=/usr/include/X11 X11LIB=/usr/lib/X11 \
    CFLAGS=" -Wall -Os ${INCS} -DVERSION=\"${VERSION}\" -DDZEN_XINERAMA -DDZEN_XPM -DDZEN_XFT `pkg-config --cflags xft`" \
    LIBS=" -L/usr/lib -lc -L${X11LIB} -lXss -lX11 -lXinerama -lXpm `pkg-config --libs xft`"
}

package() {
  cd "$srcdir/$_gitname"

  make PREFIX=/usr DESTDIR=$pkgdir/ install

  #license
  install -m644 -D LICENSE $pkgdir/usr/share/licenses/$_gitname/COPYING

  #docs
  mkdir -p $pkgdir/usr/share/doc/$_gitname
  cp README* $pkgdir/usr/share/doc/$_gitname

  #gadgets
  cd gadgets
  make X11INC=/usr/include/X11 X11LIB=/usr/lib/X11
  make PREFIX=/usr DESTDIR=$pkgdir install

  #docs
  cp README* $pkgdir/usr/share/doc/$_gitname
}
